# Traefik Configuration

This directory contains the Traefik reverse proxy configuration for the DannigOptica project.

## Files

- `traefik.yml` - Static configuration for Traefik
- `generate-certs.sh` - Script to generate self-signed certificates for local development
- `certs/` - Directory containing SSL certificates (generated by script)
- `letsencrypt/` - Directory for Let's Encrypt certificates (for production)

## Setup for Local Development

### 1. Generate Self-Signed Certificates

Run the certificate generation script:

```bash
./traefik/generate-certs.sh
```

This will create:
- `certs/dannig.key` - Private key
- `certs/dannig.crt` - Self-signed certificate

### 2. Configure Hosts File

Add the following entries to your `/etc/hosts` file (Linux/Mac) or `C:\Windows\System32\drivers\etc\hosts` (Windows):

```
127.0.0.1 dannig.local
127.0.0.1 app.dannig.local
127.0.0.1 api.dannig.local
127.0.0.1 db.dannig.local
127.0.0.1 dashboard.dannig.local
127.0.0.1 traefik.dannig.local
```

On Linux/Mac:
```bash
sudo nano /etc/hosts
```

On Windows:
```powershell
notepad C:\Windows\System32\drivers\etc\hosts
```

### 3. Browser Security Warning

Since we're using self-signed certificates, your browser will show a security warning. This is normal for local development. Click "Advanced" and then "Proceed to site" (or similar option).

## Production Setup (Let's Encrypt)

For production, you should use Let's Encrypt certificates instead of self-signed ones:

1. Update `traefik/traefik.yml` to use ACME resolver instead of file-based certificates
2. Uncomment the ACME configuration in `docker-compose.traefik.yml`
3. Ensure your domain DNS points to your server
4. Let's Encrypt will automatically issue certificates

## Access Points

Once configured, you can access:

- **Frontend**: https://app.dannig.local:8443 or https://dannig.local:8443
- **Backend API**: https://api.dannig.local:8443
- **Adminer (DB)**: https://db.dannig.local:8443
- **Traefik Dashboard**: https://dashboard.dannig.local:8443

## Troubleshooting

### Certificates not working

- Ensure certificates are generated: `ls -la traefik/certs/`
- Check file permissions: certificates should be readable by Traefik
- Verify hosts file entries are correct

### Services not accessible

- Check Traefik logs: `docker logs dannig-traefik`
- Verify labels are correct in docker-compose.traefik.yml
- Check network connectivity: `docker network inspect dannig-network`

### Port conflicts

- Update port mappings in `.env` file
- Check which ports are in use: `sudo netstat -tulpn | grep LISTEN` (Linux) or `netstat -ano | findstr LISTEN` (Windows)

